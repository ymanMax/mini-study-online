<!--pages/community/index.wxml-->
<view class="community-container">
  <!-- é¡¶éƒ¨æœç´¢æ  -->
  <view class="search-bar">
    <input class="search-input" placeholder="æœç´¢è¯é¢˜ã€é—®é¢˜æˆ–ç”¨æˆ·" value="{{searchKeyword}}" bindinput="onSearchInput" />
    <button class="search-btn" bindtap="onSearch">æœç´¢</button>
  </view>

  <!-- å‘å¸ƒæŒ‰é’® -->
  <view class="publish-section">
    <button class="publish-btn" bindtap="onPublish">å‘å¸ƒè¯é¢˜</button>
  </view>

  <!-- è¯é¢˜åˆ—è¡¨ -->
  <view class="topic-list">
    <block wx:for="{{topics}}" wx:key="id">
      <view class="topic-item" bindtap="goToTopicDetail" data-topic="{{item}}">
        <view class="topic-header">
          <image class="avatar" src="{{item.author.avatar}}" />
          <view class="user-info">
            <text class="username">{{item.author.username}}</text>
            <text class="post-time">{{item.postTime}}</text>
          </view>
          <block wx:if="{{item.author.isTeacher}}">
            <text class="teacher-tag">è®²å¸ˆ</text>
          </block>
        </view>
        <view class="topic-content">
          <text class="topic-title">{{item.title}}</text>
          <text class="topic-desc">{{item.description}}</text>
        </view>
        <view class="topic-stats">
          <view class="stat-item">
            <text class="stat-icon">ğŸ’¬</text>
            <text class="stat-text">{{item.comments}}æ¡è¯„è®º</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ‘</text>
            <text class="stat-text">{{item.likes}}ä¸ªèµ</text>
          </view>
          <view class="stat-item">
            <text class="stat-icon">ğŸ“Š</text>
            <text class="stat-text">{{item.views}}æ¬¡æµè§ˆ</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- å­¦ä¹ å°ç»„ -->
  <view class="group-section">
    <view class="section-title">
      <text>çƒ­é—¨å­¦ä¹ å°ç»„</text>
      <button class="more-btn" bindtap="goToGroups">æ›´å¤š</button>
    </view>
    <view class="group-list">
      <block wx:for="{{groups}}" wx:key="id">
        <view class="group-item" bindtap="joinGroup" data-group="{{item}}">
          <image class="group-avatar" src="{{item.avatar}}" />
          <view class="group-info">
            <text class="group-name">{{item.name}}</text>
            <text class="group-desc">{{item.description}}</text>
            <text class="group-members">{{item.members}}äºº</text>
          </view>
          <button class="join-btn" wx:if="{{!item.joined}}">åŠ å…¥</button>
          <button class="joined-btn" wx:else>å·²åŠ å…¥</button>
        </view>
      </block>
    </view>
  </view>
</view>
